import xml.etree.ElementTree as ET
import sys

hvlred = "\n            :YB##P!            \n          Y#BGPPG#B~          \n         ~7~~~~~!!7J!         \n        5##&&&&#&&&#G^        \n        #&&&&&&&#&&#&G          HVLR3D Gururla Sunar\n        .#&&&&&&&##&&P          In the memory of onurhan\n        ~^B&&&&&##&&5:          Çıktınız nuclei-input.txt hazır.\n      .5&B~B&&&&&&G?5&5.      \n   .~5&&&&#!B&&&&GJ#&&&&5~.   \n :G&&&&&&&&#J#&&PP&&&##&&&&P: \n7&&&&&&&&&&&&5#BB&&&&##&&&&&&!\n#&&&&&&&&&&&&&B#&&&&&&&&&&&&&5\n7&&&&&&&&&&&&&&&&&&&&&&&&&&&#.\n.5&&&&&&&&&&&&&&#&&#&&#&#&&#: \n:.5B&&&&&&&&&&&#&&&&&&&&&&B!  \n^:!.?G#&&&&&&&&&&&&&&&&&GJ^ : \n  !:^^!Y75B#&&&&##BPY!~^ .^ : \n  ^:::.~. :~^~^^..  . .: :^ : \n   .. .::  ^^:..:.. . .:~:.   \n   ..   . .: :  : :   .: :.   \n   ..   ^    ~  ^     :^      \n                      :.      \n"
print(hvlred)
fileName = sys.argv[1]

mainTree = ET.parse(fileName)
root = mainTree.getroot()

hosts = []
host_ports = set()

for reportHost in root.findall('.//ReportHost'):
    host = reportHost.get('name')
    for reportItem in reportHost.findall('.//ReportItem'):
        host_ports.add(reportItem.get('port'))
    for i in host_ports:
        if i == "443":
            hosts.append("https://"+host+"/"+"\n")
        elif i == "0":
            continue
        else:
            hosts.append("http://"+host+":"+i+"/"+"\n")

f = open("nuclei-input.txt", "w")

for h in hosts:
    f.write(h)

f.close()

